<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Receiving authentication</title>
  <script type="text/javascript">
    window.oauthParams = {};

    // parse the query string
    var params = {}, queryString = location.hash.substring(1),
        regex = /([^&=]+)=([^&]*)/g, m;

    while (m = regex.exec(queryString)) {
      oauthParams[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
    }
    console.log('using setOauthParams');
    window.opener?window.opener.setOauthParams(oauthParams):window.setOauthParams(oauthParams);
    window.close();
  </script>
</head>
<body>
<p>Finishing authentication...</p>
</body>
</html>
